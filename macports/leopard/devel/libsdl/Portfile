PortSystem      1.0

name            libsdl
set my_name     SDL
version         1.2.13
revision        3
categories      devel multimedia
platforms       macosx freebsd
maintainers     nox openmaintainer
description     Cross-platform multi-media development API
patchfiles	patch-fatbuild.sh

long_description \
    Simple DirectMedia Layer is a cross-platform multimedia library designed \
    to provide fast access to the graphics framebuffer and audio device. It is \
    used by MPEG playback software, emulators, and many popular games, including \
    the award winning Linux port of \"Civilization: Call To Power.\" Simple \
    DirectMedia Layer supports Linux, Win32, BeOS, Mac OS, Solaris, IRIX, and FreeBSD.

homepage        http://www.libsdl.org/
master_sites    ${homepage}release/
distname        ${my_name}-${version}

checksums       md5 c6660feea2a6834de10bc71b2f8e4d88 \
                sha1 51fcaa3e1d5c01fd813ea08688780f86b19cf539 \
                rmd160 ed8825fc98f4b3759cf9e5cf8357d71c50df9925

depends_lib     lib:libX11.6:XFree86

configure { }

build {
		system "prefix=${prefix} sh build-scripts/fatbuild.sh"
}

destroot {
		system "DESTDIR=${destroot} prefix=${prefix} sh build-scripts/fatbuild.sh install"
}

use_parallel_build  yes

set docdir      ${prefix}/share/doc/${name}-${version}

post-destroot {
    xinstall -d ${destroot}${docdir}/html

    xinstall -m 0644 -W ${worksrcpath} BUGS COPYING CREDITS INSTALL README README-SDL.txt \
        README.MacOSX TODO ${destroot}${docdir}

    xinstall -m 0644 -W ${worksrcpath} docs.html docs/index.html ${destroot}${docdir}/html
    reinplace {s@docs/@@g} ${destroot}${docdir}/html/docs.html

    foreach {dir} {html images} {
        xinstall -d ${destroot}${docdir}/html/${dir}
        eval xinstall -m 0644 [glob ${worksrcpath}/docs/${dir}/*] ${destroot}${docdir}/html/${dir}
    }
}

livecheck.check regex
livecheck.url   ${homepage}download.php
livecheck.regex ${my_name}-(\\d+(?:\\.\\d+)*)
